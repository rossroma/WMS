{"level":"error","message":"清理历史消息失败: Message.destroy is not a function","stack":"TypeError: Message.destroy is not a function\n    at /Users/mac/projects/WMS/backend/src/services/cronService.js:49:28\n    at retry (/Users/mac/projects/WMS/backend/src/services/cronService.js:26:18)\n    at retry (/Users/mac/projects/WMS/backend/src/services/cronService.js:30:12)\n    at async cleanOldMessages (/Users/mac/projects/WMS/backend/src/services/cronService.js:48:20)","timestamp":"2025-05-20 02:00:07"}
{"level":"error","message":"未处理的Promise拒绝: AppError is not a constructor","stack":"TypeError: AppError is not a constructor\n    at exports.getUserList (/Users/mac/projects/WMS/backend/src/controllers/userController.js:25:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-05-20 21:41:36"}
{"level":"error","message":"未捕获的异常: app.use() requires a middleware function","stack":"TypeError: app.use() requires a middleware function\n    at Function.use (/Users/mac/projects/WMS/backend/node_modules/express/lib/application.js:217:11)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:96:5)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:142:12)\n    at node:internal/main/run_main_module:28:49","timestamp":"2025-05-20 21:42:23"}
{"level":"error","message":"未捕获的异常: app.use() requires a middleware function","stack":"TypeError: app.use() requires a middleware function\n    at Function.use (/Users/mac/projects/WMS/backend/node_modules/express/lib/application.js:217:11)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:96:5)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:142:12)\n    at node:internal/main/run_main_module:28:49","timestamp":"2025-05-20 21:42:24"}
{"level":"error","message":"未捕获的异常: app.use() requires a middleware function","stack":"TypeError: app.use() requires a middleware function\n    at Function.use (/Users/mac/projects/WMS/backend/node_modules/express/lib/application.js:217:11)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:96:5)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:142:12)\n    at node:internal/main/run_main_module:28:49","timestamp":"2025-05-20 21:42:39"}
{"level":"error","message":"未捕获的异常: app.use() requires a middleware function","stack":"TypeError: app.use() requires a middleware function\n    at Function.use (/Users/mac/projects/WMS/backend/node_modules/express/lib/application.js:217:11)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:96:5)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:142:12)\n    at node:internal/main/run_main_module:28:49","timestamp":"2025-05-20 21:42:40"}
{"level":"error","message":"未捕获的异常: app.use() requires a middleware function","stack":"TypeError: app.use() requires a middleware function\n    at Function.use (/Users/mac/projects/WMS/backend/node_modules/express/lib/application.js:217:11)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:96:5)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:142:12)\n    at node:internal/main/run_main_module:28:49","timestamp":"2025-05-20 21:43:11"}
{"level":"error","message":"未捕获的异常: app.use() requires a middleware function","stack":"TypeError: app.use() requires a middleware function\n    at Function.use (/Users/mac/projects/WMS/backend/node_modules/express/lib/application.js:217:11)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:96:5)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:142:12)\n    at node:internal/main/run_main_module:28:49","timestamp":"2025-05-20 21:44:02"}
{"level":"error","message":"未捕获的异常: app.use() requires a middleware function","stack":"TypeError: app.use() requires a middleware function\n    at Function.use (/Users/mac/projects/WMS/backend/node_modules/express/lib/application.js:217:11)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:96:5)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:142:12)\n    at node:internal/main/run_main_module:28:49","timestamp":"2025-05-20 21:44:13"}
{"level":"error","message":"未捕获的异常: app.use() requires a middleware function","stack":"TypeError: app.use() requires a middleware function\n    at Function.use (/Users/mac/projects/WMS/backend/node_modules/express/lib/application.js:217:11)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:96:5)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:142:12)\n    at node:internal/main/run_main_module:28:49","timestamp":"2025-05-20 21:44:22"}
{"level":"error","message":"库存预警检查失败: Product is not associated to Inventory!","name":"SequelizeEagerLoadingError","stack":"SequelizeEagerLoadingError: Product is not associated to Inventory!\n    at Inventory._getIncludedAssociation (/Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:565:13)\n    at Inventory._validateIncludedElement (/Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:502:53)\n    at /Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:421:37\n    at Array.map (<anonymous>)\n    at Inventory._validateIncludedElements (/Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:417:39)\n    at Inventory.findAll (/Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:1124:12)\n    at async /Users/mac/projects/WMS/backend/src/services/cronService.js:80:14\n    at async retry (/Users/mac/projects/WMS/backend/src/services/cronService.js:26:12)\n    at async checkInventoryAlerts (/Users/mac/projects/WMS/backend/src/services/cronService.js:79:25)","timestamp":"2025-05-20 22:00:07"}
{"level":"error","message":"未捕获的异常: Route.delete() requires a callback function but got a [object Undefined]","stack":"Error: Route.delete() requires a callback function but got a [object Undefined]\n    at Route.<computed> [as delete] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/route.js:216:15)\n    at proto.<computed> [as delete] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/index.js:521:19)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js:28:14)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:23:20)","timestamp":"2025-05-20 22:24:06"}
{"level":"error","message":"未捕获的异常: Route.delete() requires a callback function but got a [object Undefined]","stack":"Error: Route.delete() requires a callback function but got a [object Undefined]\n    at Route.<computed> [as delete] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/route.js:216:15)\n    at proto.<computed> [as delete] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/index.js:521:19)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js:28:14)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:23:20)","timestamp":"2025-05-20 22:25:40"}
{"level":"error","message":"未捕获的异常: Route.delete() requires a callback function but got a [object Undefined]","stack":"Error: Route.delete() requires a callback function but got a [object Undefined]\n    at Route.<computed> [as delete] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/route.js:216:15)\n    at proto.<computed> [as delete] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/index.js:521:19)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js:28:14)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:23:20)","timestamp":"2025-05-20 22:25:42"}
{"level":"error","message":"未捕获的异常: Route.delete() requires a callback function but got a [object Undefined]","stack":"Error: Route.delete() requires a callback function but got a [object Undefined]\n    at Route.<computed> [as delete] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/route.js:216:15)\n    at proto.<computed> [as delete] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/index.js:521:19)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js:28:14)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:23:20)","timestamp":"2025-05-20 22:32:08"}
{"level":"error","message":"未捕获的异常: Route.get() requires a callback function but got a [object Undefined]","stack":"Error: Route.get() requires a callback function but got a [object Undefined]\n    at Route.<computed> [as get] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/route.js:216:15)\n    at proto.<computed> [as get] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/index.js:521:19)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js:16:8)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:23:20)","timestamp":"2025-05-20 22:34:41"}
{"level":"error","message":"未捕获的异常: Route.get() requires a callback function but got a [object Undefined]","stack":"Error: Route.get() requires a callback function but got a [object Undefined]\n    at Route.<computed> [as get] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/route.js:216:15)\n    at proto.<computed> [as get] (/Users/mac/projects/WMS/backend/node_modules/express/lib/router/index.js:521:19)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js:16:8)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/app.js:23:20)","timestamp":"2025-05-20 22:34:45"}
{"level":"error","message":"库存预警检查失败: Product is not associated to Inventory!","name":"SequelizeEagerLoadingError","stack":"SequelizeEagerLoadingError: Product is not associated to Inventory!\n    at Inventory._getIncludedAssociation (/Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:565:13)\n    at Inventory._validateIncludedElement (/Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:502:53)\n    at /Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:421:37\n    at Array.map (<anonymous>)\n    at Inventory._validateIncludedElements (/Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:417:39)\n    at Inventory.findAll (/Users/mac/projects/WMS/backend/node_modules/sequelize/lib/model.js:1124:12)\n    at async /Users/mac/projects/WMS/backend/src/services/cronService.js:80:14\n    at async retry (/Users/mac/projects/WMS/backend/src/services/cronService.js:26:12)\n    at async checkInventoryAlerts (/Users/mac/projects/WMS/backend/src/services/cronService.js:79:25)","timestamp":"2025-05-20 23:00:07"}
{"code":"MODULE_NOT_FOUND","level":"error","message":"未捕获的异常: Cannot find module '../models'\nRequire stack:\n- /Users/mac/projects/WMS/backend/src/controllers/roleController.js\n- /Users/mac/projects/WMS/backend/src/routes/roleRoutes.js\n- /Users/mac/projects/WMS/backend/src/app.js","requireStack":["/Users/mac/projects/WMS/backend/src/controllers/roleController.js","/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js","/Users/mac/projects/WMS/backend/src/app.js"],"stack":"Error: Cannot find module '../models'\nRequire stack:\n- /Users/mac/projects/WMS/backend/src/controllers/roleController.js\n- /Users/mac/projects/WMS/backend/src/routes/roleRoutes.js\n- /Users/mac/projects/WMS/backend/src/app.js\n    at Module._resolveFilename (node:internal/modules/cjs/loader:1142:15)\n    at Module._load (node:internal/modules/cjs/loader:983:27)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/controllers/roleController.js:5:23)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)","timestamp":"2025-05-20 23:25:53"}
{"code":"MODULE_NOT_FOUND","level":"error","message":"未捕获的异常: Cannot find module '../models'\nRequire stack:\n- /Users/mac/projects/WMS/backend/src/controllers/roleController.js\n- /Users/mac/projects/WMS/backend/src/routes/roleRoutes.js\n- /Users/mac/projects/WMS/backend/src/app.js","requireStack":["/Users/mac/projects/WMS/backend/src/controllers/roleController.js","/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js","/Users/mac/projects/WMS/backend/src/app.js"],"stack":"Error: Cannot find module '../models'\nRequire stack:\n- /Users/mac/projects/WMS/backend/src/controllers/roleController.js\n- /Users/mac/projects/WMS/backend/src/routes/roleRoutes.js\n- /Users/mac/projects/WMS/backend/src/app.js\n    at Module._resolveFilename (node:internal/modules/cjs/loader:1142:15)\n    at Module._load (node:internal/modules/cjs/loader:983:27)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/controllers/roleController.js:5:23)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)","timestamp":"2025-05-20 23:26:19"}
{"code":"MODULE_NOT_FOUND","level":"error","message":"未捕获的异常: Cannot find module '../models'\nRequire stack:\n- /Users/mac/projects/WMS/backend/src/controllers/roleController.js\n- /Users/mac/projects/WMS/backend/src/routes/roleRoutes.js\n- /Users/mac/projects/WMS/backend/src/app.js","requireStack":["/Users/mac/projects/WMS/backend/src/controllers/roleController.js","/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js","/Users/mac/projects/WMS/backend/src/app.js"],"stack":"Error: Cannot find module '../models'\nRequire stack:\n- /Users/mac/projects/WMS/backend/src/controllers/roleController.js\n- /Users/mac/projects/WMS/backend/src/routes/roleRoutes.js\n- /Users/mac/projects/WMS/backend/src/app.js\n    at Module._resolveFilename (node:internal/modules/cjs/loader:1142:15)\n    at Module._load (node:internal/modules/cjs/loader:983:27)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/controllers/roleController.js:5:23)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)","timestamp":"2025-05-20 23:26:21"}
{"level":"error","message":"未捕获的异常: missing ) after argument list","stack":"/Users/mac/projects/WMS/backend/src/controllers/roleController.js:110\n      fields: ['user_id', 'role_id']\n      ^^^^^^\n\nSyntaxError: missing ) after argument list\n    at internalCompileFunction (node:internal/vm:128:18)\n    at wrapSafe (node:internal/modules/cjs/loader:1279:20)\n    at Module._compile (node:internal/modules/cjs/loader:1331:27)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1426:10)\n    at Module.load (node:internal/modules/cjs/loader:1205:32)\n    at Module._load (node:internal/modules/cjs/loader:1021:12)\n    at Module.require (node:internal/modules/cjs/loader:1230:19)\n    at require (node:internal/modules/helpers:179:18)\n    at Object.<anonymous> (/Users/mac/projects/WMS/backend/src/routes/roleRoutes.js:3:24)\n    at Module._compile (node:internal/modules/cjs/loader:1368:14)","timestamp":"2025-05-20 23:36:06"}
