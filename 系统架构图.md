# WMS仓库管理系统 - 系统架构图

## 整体架构概览

```mermaid
graph TD
    %% 用户层
    User[👤 用户/管理员] --> Browser[🌐 浏览器<br/>Chrome/Firefox/Safari]
    
    %% 前端层
    Browser --> Frontend[🎨 Vue 3 前端应用<br/>Element Plus UI]
    Frontend --> Router[📍 Vue Router<br/>路由管理]
    Frontend --> Store[🗄️ Pinia 状态管理<br/>全局状态]
    Frontend --> Charts[📊 ECharts 图表<br/>数据可视化]
    
    %% HTTP通信层
    Frontend --> Axios[🔄 Axios HTTP客户端<br/>API请求/响应]
    Axios --> NProgress[⏳ NProgress<br/>加载进度条]
    
    %% 后端API层
    Axios -.->|HTTP/HTTPS| Express[🚀 Express.js 服务器<br/>RESTful API]
    Express --> Middleware{🔒 中间件层}
    
    %% 中间件组件
    Middleware --> Auth[🔑 JWT 认证<br/>Token验证]
    Middleware --> CORS[🌍 CORS 跨域<br/>资源共享]
    Middleware --> Morgan[📝 Morgan 日志<br/>HTTP请求日志]
    Middleware --> Compression[🗜️ Compression<br/>响应压缩]
    Middleware --> Multer[📁 Multer<br/>文件上传处理]
    
    %% 业务逻辑层
    Express --> Controllers[🎯 控制器层<br/>业务逻辑处理]
    Controllers --> Services[⚙️ 服务层<br/>业务服务]
    
    %% 数据访问层
    Services --> Sequelize[🔗 Sequelize ORM<br/>对象关系映射]
    Sequelize --> MySQL[(🗃️ MySQL 8.0 数据库<br/>持久化存储)]
    
    %% 外部服务
    Services --> Qiniu[☁️ 七牛云存储<br/>文件存储服务]
    Services --> Cron[⏰ Node-Cron<br/>定时任务调度]
    
    %% 日志系统
    Express --> Winston[📋 Winston Logger<br/>日志记录系统]
    Winston --> LogFiles[📄 日志文件<br/>按日期轮转]
    
    %% 部署层
    MySQL --> Docker[🐳 Docker Container<br/>容器化部署]
    
    %% 样式定义
    classDef frontend fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef backend fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef database fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef external fill:#fff3e0,stroke:#e65100,stroke-width:2px
    
    class Frontend,Router,Store,Charts,Axios,NProgress frontend
    class Express,Middleware,Auth,CORS,Morgan,Compression,Multer,Controllers,Services,Sequelize,Winston,LogFiles,Cron backend
    class MySQL,Docker database
    class Qiniu external
```

## 数据流向图

```mermaid
sequenceDiagram
    participant U as 👤 用户
    participant B as 🌐 浏览器
    participant V as 🎨 Vue前端
    participant A as 🔄 Axios
    participant E as 🚀 Express API
    participant S as 🔗 Sequelize
    participant M as 🗃️ MySQL
    
    U->>B: 1. 访问系统
    B->>V: 2. 加载Vue应用
    V->>A: 3. 发起API请求
    A->>E: 4. HTTP请求
    E->>E: 5. JWT认证验证
    E->>S: 6. ORM查询
    S->>M: 7. SQL执行
    M-->>S: 8. 返回数据
    S-->>E: 9. 对象映射
    E-->>A: 10. JSON响应
    A-->>V: 11. 数据更新
    V-->>B: 12. 页面渲染
    B-->>U: 13. 显示结果
```

## 核心技术栈

### 前端技术栈
- **Vue 3**: 渐进式JavaScript框架
- **Element Plus**: Vue 3 UI组件库
- **Vite**: 现代化构建工具
- **Vue Router**: 客户端路由管理
- **Pinia**: 状态管理库
- **Axios**: HTTP客户端库
- **ECharts**: 数据可视化图表库
- **Sass**: CSS预处理器

### 后端技术栈
- **Express.js**: Node.js Web应用框架
- **Sequelize**: MySQL/PostgreSQL/SQLite ORM
- **JWT**: JSON Web Token认证
- **bcryptjs**: 密码加密库
- **Winston**: 日志记录库
- **Multer**: 文件上传中间件
- **Node-Cron**: 任务调度器

### 数据库与存储
- **MySQL 8.0**: 关系型数据库
- **Docker**: 容器化部署
- **七牛云**: 文件存储服务

### 开发工具
- **ESLint**: 代码质量检查
- **Jest**: 单元测试框架
- **Nodemon**: 开发环境热重载

## 系统特性

### 🔒 安全特性
- JWT Token身份认证
- bcryptjs密码加密
- CORS跨域安全控制
- 请求参数验证

### 📊 监控与日志
- Winston日志系统
- Morgan HTTP请求日志
- 按日期轮转的日志文件
- API响应时间监控

### 🚀 性能优化
- Gzip响应压缩
- 前端资源懒加载
- 数据库查询优化
- 缓存机制

### 🔧 维护性
- RESTful API设计
- 模块化代码结构
- 单元测试覆盖
- Docker容器化部署

## 部署架构

```mermaid
graph TB
    subgraph "生产环境"
        subgraph "前端部署"
            Nginx[🌐 Nginx<br/>静态文件服务器]
            Static[📁 静态资源<br/>HTML/CSS/JS]
        end
        
        subgraph "后端部署"
            PM2[⚡ PM2<br/>进程管理器]
            NodeApp[🚀 Node.js 应用<br/>Express服务器]
        end
        
        subgraph "数据层"
            DockerMySQL[🐳 Docker MySQL<br/>数据库容器]
            Backup[💾 数据备份<br/>定时备份策略]
        end
        
        subgraph "外部服务"
            CDN[☁️ CDN<br/>内容分发网络]
            QiniuCloud[☁️ 七牛云<br/>文件存储]
        end
    end
    
    Nginx --> Static
    Nginx -.->|反向代理| PM2
    PM2 --> NodeApp
    NodeApp --> DockerMySQL
    NodeApp --> QiniuCloud
    DockerMySQL --> Backup
    CDN --> Nginx
```

## 接口设计原则

### RESTful API规范
- `GET` - 查询数据
- `POST` - 创建数据
- `PUT` - 更新数据
- `DELETE` - 删除数据

### 统一响应格式
```json
{
  "code": 200,
  "message": "success",
  "data": {},
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### 错误处理机制
- 统一错误码定义
- 详细错误信息返回
- 客户端友好的错误提示 